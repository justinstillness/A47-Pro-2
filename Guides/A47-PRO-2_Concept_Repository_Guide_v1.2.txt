================================================================================
CONCEPT REPOSITORY GUIDE
================================================================================
Project: A47-PRO-2 (Agenda 47 Explained)
Version: 1.2
Date: January 8, 2026
Status: DRAFT

================================================================================
TABLE OF CONTENTS
================================================================================

1. OVERVIEW
   1.1 Purpose
   1.2 Relationship to AIPM and Project Guide
   1.3 System Architecture

2. SPECIFICATIONS
   2.1 Repository Entry Format
   2.2 Index Entry Format
   2.3 Relationship Graph Format
   2.4 Domain Volume Structure

3. CONVENTIONS
   3.1 File Naming
   3.2 Source Tag Registry
   3.3 Relationship Vocabulary
   3.4 ID Assignment Rules

4. EXTRACTION PROTOCOL
   4.1 Source Package Preparation
   4.2 AI Role Assignment
   4.3 Extraction Prompt Template
   4.4 Segmentation Rules

5. AI SUBCONTRACTOR PROTOCOL
   5.1 Task Specification Requirements
   5.2 Operational Prohibitions
   5.3 Integrity Metrics
   5.4 Verification Framework

6. CONSOLIDATION PROTOCOL
   6.1 Interim Products
   6.2 Domain Routing
   6.3 Duplicate Detection
   6.4 Interim Concept Repository (ICR)

7. MERGE DECISION FRAMEWORK
   7.1 Conflict-Triggered Review
   7.2 Merge Strategies
   7.3 Execution and Housekeeping
   7.4 Batch Conflict Staging

8. VALIDATION PROTOCOL
   8.1 Four-Level Validation
   8.2 Push Deeper Protocol
   8.3 Cross-AI Validation
   8.4 Level 5: Referential Integrity

9. REPOSITORY-TO-CARD INTERFACE
   9.1 What Repository Provides
   9.2 What Cards Add
   9.3 Workflow Summary (GitHub-Enabled)
   9.4 Gap Feedback Loop
   9.5 Handoff Points

10. MIGRATION & MAINTENANCE
    10.1 Current State to Domain Volumes
    10.2 Drafting Data Extraction
    10.3 Domain Health Maintenance
    10.4 New Domain Protocol
    10.5 Index Update Protocol

APPENDICES
A. Extraction Prompt Template
B. Subcontractor Instruction Template
C. Validation Checklist Template
D. Source Tag Master List
E. Remote Repository Access Protocol

================================================================================
1. OVERVIEW
================================================================================

1.1 PURPOSE
-----------

The Concept Repository is a structured knowledge base containing atomic 
conceptual units extracted from source materials. It serves as:

- A semantic model of reality (concepts and their relationships)
- The foundation for drafting, outlining, and storyboarding work
- A queryable reference for AI collaborators across sessions
- A scalable system for managing large research corpora

The repository is NOT:
- An audit trail of its own construction (provenance is preserved minimally)
- A drafting artifact (treatment guidance lives in cards/outlines)
- A deployment tracker (usage is tracked in series artifacts)

DESIGN PRINCIPLE: The repository models reality; drafting artifacts model 
how to communicate that reality.


1.2 RELATIONSHIP TO AIPM AND PROJECT GUIDE
-------------------------------------------

Hierarchy:
- AIPM (AI Project Management Manual): Governance layer for all projects
- Content Project Guide: Methodology for content creation projects
- Concept Repository Guide (this document): Specialized protocol for 
  concept extraction, consolidation, and maintenance

This guide operates within the AIPM framework, following its conventions for:
- Session management (bootstraps, closeouts, handoffs)
- AI role separation (Librarian/Mason/Specialized roles)
- Multi-AI workflows (subcontractor protocols)
- Documentation standards


1.3 SYSTEM ARCHITECTURE
-----------------------

The Concept Repository system comprises three artifact types:

1. DOMAIN VOLUMES (10 files)
   - One file per domain
   - Contains complete repository entries
   - Primary storage for concept definitions and relationships

2. MASTER INDEX (1 file)
   - Spans all domain volumes
   - Condensed catalog format
   - Primary navigation and query layer

3. RELATIONSHIP GRAPH (1 file)
   - Edge-list format
   - Enables graph traversal queries
   - Generated from domain volume entries

Architecture Diagram:

    [Source Packages]
           |
           v
    [Extraction] ──> [ClaCON Partial Files]
           |
           v
    [Consolidation] ──> [Domain Routing]
           |
           v
    ┌──────────────────────────────────────────────────────┐
    │                   MASTER REPOSITORY                   │
    │  ┌─────────┐ ┌─────────┐ ┌─────────┐     ┌─────────┐ │
    │  │ Vol-CIV │ │Vol-CTRL │ │ Vol-LIB │ ... │Vol-META │ │
    │  └─────────┘ └─────────┘ └─────────┘     └─────────┘ │
    │                       │                               │
    │              ┌────────┴────────┐                     │
    │              │                 │                     │
    │         [MASTER INDEX]   [RELATIONSHIP GRAPH]        │
    └──────────────────────────────────────────────────────┘
           |
           v
    [Card System / Storyboards / Outlines]


================================================================================
2. SPECIFICATIONS
================================================================================

2.1 REPOSITORY ENTRY FORMAT
---------------------------

Each concept entry in a domain volume follows this structure:

```
================================================================================
[MASTER-CIV-001] Technocratic Plantation Model
================================================================================
Domain: CIV-SYS
Source: S00 | Original: S00-CIV-SYS-01
Novelty: AUTHOR-COINED
Explicitness: EXPLICIT

DEFINITION:
Modern society functions as a sophisticated control system that provides 
material benefits (electricity, medical systems, clean water, food, education) 
while creating dependency that prevents recognition of underlying enslavement.

SOURCE CONTEXT:
"modern society has been turned into a Trojan horse, meant to deceive, entrap, 
and ultimately utterly destroy any hope of freedom"

DEPENDENCIES:
- None (foundational concept)

RELATIONSHIPS:
- COMPOSES -> MASTER-CIV-002 (Trojan Horse Mechanism)
- ENABLES -> MASTER-PSYCH-001 (Dependency-Defense Dynamic)
- ENABLES -> MASTER-PSYCH-002 (Generational Forgetting)
- CONTRADICTS -> MASTER-CIV-003 (Symbiotic Civilization)
================================================================================
```

FIELD DEFINITIONS:

| Field | Required | Description |
|-------|----------|-------------|
| MASTER ID | Yes | Unique identifier: MASTER-[DOMAIN]-### |
| Concept Name | Yes | Human-readable label |
| Domain | Yes | Domain code (see Section 3.2) |
| Source | Yes | Source tag where concept originated |
| Original | Yes | ID from extraction (for traceability) |
| Novelty | Yes | AUTHOR-COINED / FRAMEWORK / ESTABLISHED |
| Explicitness | Yes | EXPLICIT / IMPLICIT / DERIVED |
| Definition | Yes | Core meaning (complete but concise) |
| Source Context | Yes | Original language (~50 words max) |
| Dependencies | Yes | Prerequisite concepts (or "None") |
| Relationships | Yes | Typed links to other concepts |

NOVELTY VALUES:
- AUTHOR-COINED: Original terminology created by the author
- FRAMEWORK: Existing term used in author's specific framework
- ESTABLISHED: Standard terminology from the field

EXPLICITNESS VALUES:
- EXPLICIT: Directly stated in source material
- IMPLICIT: Clearly implied but not directly stated
- DERIVED: Inferred through analysis of source material


2.2 INDEX ENTRY FORMAT
----------------------

The Master Index uses a condensed format for efficient navigation:

```
[MASTER-CIV-001] Technocratic Plantation Model
  CIV-SYS | AUTHOR-COINED | S00
  Deps: None (foundational)
  Rels: COMP->CIV-002, ENAB->PSYCH-001, ENAB->PSYCH-002, CONTRA->CIV-003
```

INDEX CONVENTIONS:
- Line 1: ID and Name
- Line 2: Domain | Novelty | Primary Source
- Line 3: Dependencies (abbreviated)
- Line 4: Relationships (max 5, abbreviated types)

RELATIONSHIP ABBREVIATIONS:
| Full | Abbrev |
|------|--------|
| COMPOSES | COMP |
| ENABLES | ENAB |
| CONTRADICTS | CONTRA |
| GROUNDS | GRND |
| PARALLELS | PARA |
| EXTENDS | EXT |
| INSTANCE OF | INST |

INDEX HEADER FORMAT:
```
================================================================================
MASTER CONCEPT INDEX
================================================================================
Project: A47-PRO-2
Version: [#.##]
Total Concepts: [###]
Generated: [Date]

DOMAIN SUMMARY:
- CIV-SYS: [##] concepts
- CTRL-MECH: [##] concepts
- LIB-MECH: [##] concepts
- EPIST: [##] concepts
- THEO: [##] concepts
- HIST: [##] concepts
- GEOPOL: [##] concepts
- PSYCH: [##] concepts
- STRAT-OPS: [##] concepts
- META: [##] concepts
================================================================================

[Entries follow, organized by domain]
```


2.3 RELATIONSHIP GRAPH FORMAT
-----------------------------

The Relationship Graph is a simple edge-list file for graph traversal:

```
================================================================================
MASTER CONCEPT RELATIONSHIP GRAPH
================================================================================
Project: A47-PRO-2
Total Relationships: [###]
Generated: [Date]
================================================================================

MASTER-CIV-001 COMPOSES MASTER-CIV-002
MASTER-CIV-001 ENABLES MASTER-PSYCH-001
MASTER-CIV-001 ENABLES MASTER-PSYCH-002
MASTER-CIV-001 CONTRADICTS MASTER-CIV-003
MASTER-CIV-002 ENABLES MASTER-PSYCH-001
MASTER-CIV-003 CONTRADICTS MASTER-CIV-001
...
```

FORMAT RULES:
- One relationship per line
- Format: [SOURCE-ID] [RELATIONSHIP-TYPE] [TARGET-ID]
- Relationships are directional (A ENABLES B ≠ B ENABLES A)
- Bidirectional relationships (CONTRADICTS, PARALLELS) appear twice
- No additional metadata (confidence, source) in v1.0

GENERATION:
The Relationship Graph is generated programmatically from domain volume 
entries. It is a derived artifact, not manually maintained.

BIDIRECTIONAL HANDLING:
The generation script automatically mirrors bidirectional relationships.
Entry authors only need to record the relationship once (in the originating 
entry). The script detects CONTRADICTS and PARALLELS types and creates the 
reciprocal edge automatically. This prevents manual duplication errors and 
ensures graph consistency.


2.4 DOMAIN VOLUME STRUCTURE
---------------------------

Each domain volume is a standalone file containing all concepts for that domain.

VOLUME HEADER:
```
================================================================================
MASTER CONCEPT REPOSITORY - VOLUME: CIV-SYS
================================================================================
Project: A47-PRO-2
Domain: Civilization Systems (CIV-SYS)
Version: [#.##]
Concept Count: [##]
Last Updated: [Date]
================================================================================

[Entries follow in ID order]
```

DOMAIN CODES AND DESCRIPTIONS:

| Code | Full Name | Description |
|------|-----------|-------------|
| CIV-SYS | Civilization Systems | Macro-level societal structures and models |
| CTRL-MECH | Control Mechanisms | Tools and methods of population control |
| LIB-MECH | Liberation Mechanisms | Tools and methods of freedom/resistance |
| EPIST | Epistemology | Knowledge, truth, and information dynamics |
| THEO | Theology | Religious and spiritual dimensions |
| HIST | History | Historical events, patterns, and analysis |
| GEOPOL | Geopolitics | International relations and power dynamics |
| PSYCH | Psychology | Individual and collective psychology |
| STRAT-OPS | Strategic Operations | Tactical and strategic methodologies |
| META | Meta | Cross-cutting, methodological, or uncategorized |


================================================================================
3. CONVENTIONS
================================================================================

3.1 FILE NAMING
---------------

| Artifact Type | Convention | Example |
|---------------|------------|---------|
| Domain Volume | MASTER_CON_Vol-[DOMAIN]-[SEQ]_v#.##_###.txt | MASTER_CON_Vol-CIV-001_v1.0_046.txt |
| Master Index | MASTER_Concept_Index_v#.##_###.txt | MASTER_Concept_Index_v2.1_252.txt |
| Relationship Graph | MASTER_Relationship_Graph_v#.##.txt | MASTER_Relationship_Graph_v1.0.txt |
| Partial Repository | ClaCON##_[SourceTag]_Session###.txt | ClaCON08_S04_Session057.txt |
| Segmented Extraction | ClaCON##_[SourceTag]_Seg#_Session###.txt | ClaCON08_S04_Seg3_Session057.txt |
| AI Subcontractor Output | [AI]_[ArtifactType]_[Identifier].txt | Gemini_MASTER_Concept_Index_252.txt |
| Drafting Data Extract | DRAFTING_DATA_EXTRACT_[DOMAIN]_v#.#.txt | DRAFTING_DATA_EXTRACT_CIV_v1.0.txt |
| ICR Repository | ICR_Repository_v#.##_###.txt | ICR_Repository_v1.0_027.txt |
| ICR Index | ICR_Index_v#.##_###.txt | ICR_Index_v1.0_027.txt |

NAMING ELEMENTS:
- Version (v#.##): Major.Minor versioning
- Count (###): Number of concepts in file (use leading zeros: 046, 252)
- Session (Session###): Session number where file was created
- Segment (Seg#): Segment number for large source extractions
- Sequence ([SEQ]): Three-digit volume sequence within domain (001, 002, etc.)
- SourceTag: See Section 3.2

VOLUME SEQUENCE CONVENTION:
Domain volumes use a sequence number to support scaling:
- MASTER_CON_Vol-CIV-001_v1.0_046.txt (concepts 1-46)
- MASTER_CON_Vol-CIV-002_v1.0_052.txt (concepts 47-98)
- MASTER_CON_Vol-PHIL-001_v1.0_075.txt
- MASTER_CON_Vol-PHIL-012_v1.0_068.txt

This allows domains to grow to hundreds or thousands of concepts across 
multiple volume files. The Master Index tracks which volume contains which 
ID ranges. See Section 10.3 for volume segmentation thresholds.

GITHUB COMPATIBILITY:
For GitHub-hosted files, use underscores instead of spaces. The naming 
conventions above are already GitHub-compatible. See Appendix E for 
remote repository access protocol.


3.2 SOURCE TAG REGISTRY
-----------------------

Source tags identify the origin of concepts for traceability.

PUBLISHED SOURCES:
| Tag | Description |
|-----|-------------|
| S00 | Synopsis |
| S01 | Article 1 (Introduction) |
| S02 | Article 2 (Part 1) |
| S03 | Article 3 (Part 2) |
| S04+ | Future published articles (sequential) |
| BR | A47 Briefs collection |

DRAFT SOURCES:
| Tag | Description |
|-----|-------------|
| EG | Endgame draft |
| DR-## | Unpublished drafts (numbered sequentially) |

INTERNAL SOURCES:
| Tag | Description |
|-----|-------------|
| MEMO | Thesis Memo / strategic notes |
| RES-## | Research materials (numbered) |
| COM-## | Storyboard/outline review commentary (numbered) |

ASSIGNMENT RULES:
- New published articles get next S## number
- New drafts get next DR-## number
- Commentary files from outline review get COM-## (by outline number)
- Research materials get RES-## (by date or topic)


3.3 RELATIONSHIP VOCABULARY
---------------------------

Seven relationship types define concept interconnections:

| Type | Meaning | Example |
|------|---------|---------|
| COMPOSES | Part-whole relationship | "Trojan Horse Mechanism COMPOSES Technocratic Plantation" |
| ENABLES | Causal or facilitative | "Dependency creates conditions for Generational Forgetting" |
| CONTRADICTS | Opposition or tension | "Symbiotic Civilization CONTRADICTS Parasitic Model" |
| GROUNDS | Foundational support | "Historical Pattern GROUNDS Current Analysis" |
| PARALLELS | Structural similarity | "Religious Control PARALLELS Financial Control" |
| EXTENDS | Elaboration or expansion | "Application EXTENDS Core Doctrine" |
| INSTANCE OF | Type-token relationship | "Specific Event INSTANCE OF General Pattern" |

USAGE NOTES:
- ENABLES subsumes former "MECHANISM FOR" (use ENABLES for both)
- Directionality matters: A ENABLES B means A creates conditions for B
- CONTRADICTS and PARALLELS are inherently bidirectional
- Limit to 5-7 relationships per concept to maintain usability


3.4 ID ASSIGNMENT RULES
-----------------------

MASTER ID FORMAT: MASTER-[DOMAIN]-###

ASSIGNMENT PROTOCOL:
1. New concepts receive the next sequential ID in their domain
2. IDs are permanent—never reused even if concept is deleted
3. Original extraction IDs preserved in "Original" field for traceability
4. Cross-domain moves require new ID in target domain (old ID deprecated)

EXAMPLE:
- Current highest CIV ID: MASTER-CIV-046
- New CIV concept extracted: Assigned MASTER-CIV-047
- Original extraction ID (e.g., S04-CIV-SYS-03) recorded in entry

ID COLLISION HANDLING:
If extraction produces an ID that conflicts with existing:
1. Preserve both concepts
2. Document collision in session log
3. Librarian reviews for potential merge or disambiguation


================================================================================
4. EXTRACTION PROTOCOL
================================================================================

4.1 SOURCE PACKAGE PREPARATION
------------------------------

Before extraction, prepare the source package:

1. IDENTIFY SOURCE TYPE
   - Commentary file (outline review notes)
   - Report (outline report, argument framework)
   - Draft material (unpublished content)
   - Research material (external sources)

2. ASSIGN SOURCE TAG
   - Check Source Tag Registry (Section 3.2)
   - Assign next available tag if new source type
   - Document in session log

3. ESTIMATE SCOPE
   - Word count (affects segmentation decision)
   - Concept density (high-density sources need more segments)
   - Domain distribution (anticipate routing needs)

4. PRE-CHECK FOR DUPLICATES
   - Load Master Index
   - Identify concepts likely already captured
   - Note for extraction AI to flag potential overlaps


4.2 AI ROLE ASSIGNMENT
----------------------

EXTRACTION PHASE:
| Role | AI | Responsibility |
|------|-----|----------------|
| Extractor | Gemini/Grok | Bulk concept extraction from source |
| Quality Control | Claude | Review extraction output, validate format |
| Decision Maker | Librarian (Human) | Resolve ambiguities, approve merges |

CONSOLIDATION PHASE:
| Role | AI | Responsibility |
|------|-----|----------------|
| Consolidator | Gemini/Grok | Merge partial files (large scale) |
| Consolidator | Claude | Merge partial files (<100 concepts) |
| Validator | Claude (fresh context) | Verify consolidation integrity |

RATIONALE:
- Gemini/Grok: Larger context windows for bulk operations
- Claude: Superior judgment for quality control and semantic decisions
- Fresh context validation prevents confirmation bias


4.3 EXTRACTION PROMPT TEMPLATE
------------------------------

See Appendix A for complete template.

KEY ELEMENTS:
1. Source identification and scope
2. Entry format specification (Section 2.1)
3. Domain assignment guidance
4. Explicitness and novelty determination rules
5. Relationship identification instructions
6. Output requirements (counts, verification)


4.4 SEGMENTATION RULES
----------------------

THRESHOLDS:
| Source Size | Action |
|-------------|--------|
| <10,000 words | Single extraction session |
| 10,000-30,000 words | 2-3 segments |
| 30,000-60,000 words | 4-6 segments |
| >60,000 words | Segment by natural divisions (chapters, sections) |

SEGMENTATION PROCESS:
1. Identify natural break points (section headers, topic shifts)
2. Create segment files with clear boundaries
3. Name segments: ClaCON##_[SourceTag]_Seg#_Session###.txt
4. Include overlap context (last paragraph of previous segment) in each
5. Include Key Concept Carry-over list (see below)
6. Track segment-to-source mapping in session log

KEY CONCEPT CARRY-OVER:
To prevent duplicate ID assignment for concepts that bridge segment breaks:

1. At the start of each segment (after Seg1), include a carry-over list:
   ```
   KEY CONCEPT CARRY-OVER FROM PREVIOUS SEGMENT:
   - [Concept Name 1] (assigned ID: [SourceTag]-[DOMAIN]-##)
   - [Concept Name 2] (assigned ID: [SourceTag]-[DOMAIN]-##)
   - [Concept Name 3] (in progress, not yet assigned)
   ```

2. Extractor checks this list before assigning new IDs
3. If a concept from the carry-over list appears again, use existing ID
4. If a concept was "in progress," complete it in current segment

This prevents the AI from creating two different IDs for the same concept 
that spans a segment boundary.

CROSS-SEGMENT HANDLING:
- Concepts spanning segments: Assign to segment where most fully developed
- Note cross-references in Dependencies/Relationships
- Consolidation phase resolves any fragments


================================================================================
5. AI SUBCONTRACTOR PROTOCOL
================================================================================

This protocol governs all work delegated to AI systems (Gemini, Grok, or 
Claude in subcontractor role). Developed from documented failure patterns.

5.1 TASK SPECIFICATION REQUIREMENTS
-----------------------------------

Every subcontractor task must include:

1. COMPLETE FILE REQUIREMENT
   - Deliver complete output file, not corrections or patches
   - No partial outputs or "see previous" references

2. VERIFICATION CHECKSUMS
   - Pre-calculated concept count (total and per-domain)
   - Expected line count range (±10%)
   - Source file checksums if applicable

3. ID COLLISION PROTOCOL
   - If ID conflicts detected, preserve both entries
   - Flag conflict for Librarian review
   - Never silently merge or override

4. FORMAT SPECIFICATION
   - Exact entry format (provide template)
   - Field order and delimiters
   - Prohibited formatting (see Section 5.2)


5.2 OPERATIONAL PROHIBITIONS
----------------------------

AI subcontractors are PROHIBITED from:

1. PLACEHOLDERS
   - No "[remaining concepts follow same pattern]"
   - No "..." or "[truncated]" markers
   - No "etc." in place of actual content

2. TRUNCATION
   - No cutting off before completion
   - No "output limit reached" without flagging incomplete
   - Must deliver complete file or explicitly state incomplete

3. SUMMARIZATION
   - No paraphrasing definitions (verbatim only)
   - No condensing source context without authorization
   - No combining concepts without explicit instruction

4. UNAUTHORIZED MODIFICATIONS
   - No count modifications (must match provided checksum)
   - No format deviations
   - No domain reassignments without flagging
   - No relationship additions/removals without basis in source

5. FALSE COMPLETION CLAIMS
   - No "task complete" when truncated
   - No validation claims without actual verification
   - No count confirmations without actual counting

6. ABBREVIATIONS IN DOMAIN VOLUMES
   - No abbreviated relationship types (use COMPOSES not COMP)
   - No abbreviated field names (use DEPENDENCIES not Deps)
   - Full field names and relationship types required in all volume entries
   - Abbreviations permitted ONLY in Index entries (see Section 2.2)


5.3 INTEGRITY METRICS
---------------------

Subcontractor output must meet:

1. LINE COUNT
   - Within ±10% of expected (based on similar prior work)
   - Significant deviation triggers review

2. CONCEPT COUNT
   - Exact match to pre-calculated total
   - Per-domain counts must sum to total

3. VERBATIM PRESERVATION
   - Definitions unchanged from source
   - Source Context quoted exactly
   - No editorial modifications

4. FORMAT COMPLIANCE
   - All required fields present
   - Field order matches specification
   - Delimiter consistency


5.4 VERIFICATION FRAMEWORK
--------------------------

Four-level verification for all subcontractor outputs:

LEVEL 1: STRUCTURAL VERIFICATION
- File opens without errors
- All entries parseable
- Header/footer present and correct
- No orphan text outside entries

LEVEL 2: COUNT VERIFICATION
- Total concept count matches expectation
- Per-domain counts accurate
- No duplicate IDs
- No ID gaps (within expected range)

LEVEL 3: VERBATIM VERIFICATION
- Spot-check 10-15 entries against source
- Verify first 15 words of definition match exactly
- Check source context quotes are accurate

LEVEL 4: CROSS-VALIDATION
- Second AI (fresh context) validates against inputs
- Compare output to source independently
- Report any discrepancies

ESCALATION:
- Level 1-2 failures: Reject output, re-task
- Level 3 failures: Identify scope of issue, partial re-task or manual fix
- Level 4 discrepancies: Librarian review for resolution


================================================================================
6. CONSOLIDATION PROTOCOL
================================================================================

6.1 INTERIM PRODUCTS
--------------------

Consolidation produces intermediate artifacts before final volume integration:

EXTRACTION OUTPUT:
- ClaCON##_[SourceTag]_Session###.txt
- Contains concepts from single source or segment
- Domain assignments included but not yet routed

CONSOLIDATED PARTIAL:
- ClaCON##_[SourceTag]_CONSOLIDATED_Session###.txt
- Merged segments from single source
- Ready for domain routing

DOMAIN-ROUTED BATCH:
- ClaCON##_[SourceTag]_[DOMAIN]_Session###.txt
- Concepts for single domain from single source
- Ready for volume integration


6.2 DOMAIN ROUTING
------------------

After consolidation, concepts route to domain volumes:

PROCESS:
1. Parse consolidated partial file
2. Group concepts by domain assignment
3. Create domain-specific batch files
4. Verify batch counts sum to total
5. Queue batches for volume integration

ROUTING DECISION TREE:
```
For each concept:
  1. Check assigned domain
  2. If domain = one of 10 defined → Route to that volume
  3. If domain = unclear/multiple → Route to META, flag for review
  4. If domain = genuinely new → Route to META, flag for new domain evaluation
```

CROSS-DOMAIN CONCEPTS:
Some concepts legitimately span domains. Handling:
- Primary domain: Where concept is most fully developed
- Secondary domains: Noted in Relationships (PARALLELS or EXTENDS)
- Do not duplicate entry across volumes


6.3 DUPLICATE DETECTION
-----------------------

Duplicates detected during consolidation, not pre-filtered.

DETECTION TRIGGERS:
- Exact name match
- Definition similarity >80%
- Same source context quote
- Overlapping relationship sets

HANDLING:
1. Flag potential duplicate
2. Present both entries to Librarian
3. Apply Merge Decision Framework (Section 7)
4. Document resolution in session log

PRE-EXTRACTION INDEX CHECK:
- Review Master Index before extraction
- Note likely overlaps for extractor
- Not a filter—extraction proceeds fully
- Helps extractor flag variants vs. true duplicates


6.4 INTERIM CONCEPT REPOSITORY (ICR)
------------------------------------

The ICR provides a staging layer for concepts generated during active editing 
work (outline review, card development, draft revision) that need to be usable 
immediately without waiting for full MASTER integration.

PURPOSE:
- Fast extraction pass for concepts generated during editing
- Immediate usability in cards and outlines
- Accumulation across sessions until integration threshold
- Reduced bottleneck in editing workflow

ICR ENTRY FORMAT:
```
================================================================================
[ICR-###] Concept Name
================================================================================
Domain: [DOMAIN] (provisional)
Source: [SourceTag] (e.g., COM-03)
Novelty: [AUTHOR-COINED / FRAMEWORK / ESTABLISHED]
Explicitness: [EXPLICIT / IMPLICIT / DERIVED]

DEFINITION:
[Definition text]

SOURCE CONTEXT:
[Quote, ~50 words max]

DEPENDENCIES:
- ICR-### or MASTER-###-###

RELATIONSHIPS:
- [TYPE] -> ICR-### or MASTER-### ([Concept Name])

STAGING NOTES:
- Generated: [Session], [Date]
- Pending: [Any known integration considerations]
================================================================================
```

ICR ID FORMAT:
- Temporary IDs: ICR-### (three-digit sequential)
- IDs reset after each integration batch
- Original ICR ID recorded in MASTER entry after integration

MIXED REFERENCES:
ICR entries can reference:
- Other ICR concepts (ICR-###)
- Existing MASTER concepts (MASTER-###-###)
Cards can reference both ICR and MASTER concepts simultaneously.

ICR INDEX:
Maintain lightweight index alongside ICR Repository:
```
================================================================================
INTERIM CONCEPT INDEX
================================================================================
Project: A47-PRO-2
Status: STAGING
Concept Count: [##]
Last Updated: [Date]
================================================================================

[ICR-001] Concept Name
  DOMAIN (provisional) | NOVELTY | SOURCE
  Deps: [refs]
  Rels: [refs]
--------------------------------------------------------------------------------
```

DUAL-INDEX WORKFLOW:
During active editing, Claude queries both indexes:
1. MASTER_Concept_Index (integrated concepts)
2. ICR_Index (staging concepts)
Both are searched for any concept query; source identified for fetch.

INTEGRATION THRESHOLD:
- Target: ~75 concepts in ICR
- Alternative trigger: Natural project milestone (article completion)
- Integration process: See Section 7 (Merge Decision Framework)

INTEGRATION PROCESS:
1. Export ICR Repository and ICR Index
2. Run duplicate detection against MASTER Index
3. Flag conflicts for Librarian review
4. Generate preliminary MASTER ID assignments
5. Execute merge via Gemini subcontractor
6. Validate merged volumes (Levels 1-5)
7. Generate migration map (ICR-### → MASTER-###-###)
8. Update card references using migration map
9. Push updated volumes to GitHub
10. Reset ICR Repository and ICR Index to empty

MIGRATION MAP FORMAT:
```
================================================================================
ICR MIGRATION MAP
================================================================================
Integration Date: [Date]
Session: [###]
Concepts Migrated: [##]
================================================================================

ICR-001 → MASTER-CIV-047
ICR-002 → MASTER-PSYCH-089
ICR-003 → MASTER-CIV-048
...
================================================================================
```

GITHUB HOSTING:
ICR files hosted alongside MASTER volumes:
```
/A47-PRO-2/
  /ICR/
    ICR_Repository_current.txt
    ICR_Index_current.txt
```


================================================================================
7. MERGE DECISION FRAMEWORK
================================================================================

7.1 CONFLICT-TRIGGERED REVIEW
-----------------------------

The repository uses conflict-triggered review rather than static 
PROVISIONAL/CRYSTALLIZED flags.

PRINCIPLE:
- All concepts in MASTER volumes represent current best understanding
- When new extraction conflicts with existing entry, conflict triggers review
- Review may rework new concept OR trigger system-wide update

CONFLICT TYPES:
1. DEFINITION CONFLICT: New extraction defines concept differently
2. RELATIONSHIP CONFLICT: Different relationship claims
3. SCOPE CONFLICT: Broader/narrower scope for same concept
4. SOURCE CONFLICT: Different source context, same concept

RESOLUTION PATHS:
- REWORK NEW: New extraction adjusted to align with existing
- ENRICH EXISTING: Existing entry enhanced with new information
- SUPERSEDE: New extraction replaces existing (with audit trail)
- SPLIT: Single concept becomes multiple distinct concepts
- MERGE: Multiple concepts consolidated into one


7.2 MERGE STRATEGIES
--------------------

Four strategies for handling concept overlaps:

FULL CONSOLIDATION
- Use when: Scattered references to same concept across sources
- Action: Unify into single comprehensive entry
- Preserve: Best definition, richest context, all relationships
- Example: Three partial references → one complete entry

CONSERVATIVE/TIGHT MERGE
- Use when: Similar but potentially distinct concepts
- Action: Merge only direct overlaps, preserve distinct elements
- Preserve: "Iceberg tips" that might seed distinct arguments
- Example: Keep separate if treatment might differ in drafting

LOGICAL GROUPING
- Use when: Concepts form a natural chain
- Action: Create explicit EXTENDS relationships
- Preserve: Individual entries with clear progression
- Example: Doctrine → Framework → Application as linked chain

ENRICHMENT
- Use when: New information supplements existing entry
- Action: Add to foundational entry, don't replace
- Preserve: Original definition, add new context or relationships
- Example: New source adds supporting quote to existing concept


7.3 EXECUTION AND HOUSEKEEPING
------------------------------

MERGE EXECUTION:
1. Librarian designates canonical entry (which survives)
2. Document merge rationale in session log
3. Update canonical entry with merged content
4. Update Relationships pointing to deprecated entry
5. Remove deprecated entry from volume
6. Update Index and Relationship Graph
7. Note merge in Drafting Data Extract if relevant fields lost

HOUSEKEEPING CHECKLIST:
□ Canonical entry complete and accurate
□ All relationship pointers updated across all volumes
□ Deprecated entry removed
□ Index regenerated with correct counts
□ Relationship Graph regenerated
□ Session log documents merge decision and rationale
□ Any drafting-relevant data preserved in extract file


7.4 BATCH CONFLICT STAGING
--------------------------

For large extractions with multiple potential conflicts, use a staging area 
to review all conflicts before any volume integration.

WHEN TO USE:
- Extraction batch >30 concepts
- Multiple source packages processed together
- Known high-overlap with existing content

STAGING PROCESS:
1. Complete extraction to ClaCON files
2. Run duplicate detection against MASTER Index
3. Separate clean concepts from conflict candidates
4. Create staging file: CONFLICTS_[SourceTag]_Session###.txt

CONFLICT STAGING FILE FORMAT:
```
================================================================================
CONFLICT STAGING FILE
================================================================================
Source: [SourceTag]
Session: [###]
Total Extracted: [##]
Clean (no conflicts): [##]
Conflicts Requiring Review: [##]
================================================================================

CONFLICT #1:
-----------
NEW CONCEPT:
[Full entry from extraction]

EXISTING CONCEPT:
[Full entry from MASTER volume]

CONFLICT TYPE: [DEFINITION / RELATIONSHIP / SCOPE / SOURCE]
SUGGESTED RESOLUTION: [REWORK NEW / ENRICH / SUPERSEDE / SPLIT / MERGE]
NOTES: [Any context for decision]

================================================================================
[Repeat for each conflict]
================================================================================
```

RESOLUTION WORKFLOW:
1. Librarian reviews all conflicts in staging file
2. Annotates suggested resolution for each
3. Clean concepts integrate immediately
4. Conflicts integrate after resolution decisions made
5. Prevents partial integration of disputed material


7.4 BATCH CONFLICT STAGING
--------------------------

For large extractions or ICR integrations with multiple potential conflicts,
use a staging approach to prevent partial integration of disputed material.

WHEN TO USE:
- ICR integration batch with >20 concepts
- Large source package extraction (>50 concepts)
- Multiple sources being consolidated simultaneously
- Any batch where conflict rate is expected to be high

STAGING PROCESS:
1. Create staging file: CONFLICTS_[SourceTag]_Session###.txt
2. Run full duplicate detection against MASTER Index
3. Route all flagged conflicts to staging file (not to volumes)
4. Route clean concepts to appropriate domain volumes
5. Review all staged conflicts before any volume integration
6. Resolve conflicts per Section 7.1 protocols
7. Integrate resolved concepts
8. Archive or delete staging file

STAGING FILE FORMAT:
```
================================================================================
CONFLICT STAGING FILE
================================================================================
Source: [SourceTag or ICR Integration]
Session: [###]
Date: [Date]
Conflicts Detected: [##]
================================================================================

[CONFLICT-001]
NEW CONCEPT: [ICR-### or extraction ID]
  Name: [Concept Name]
  Definition: [Definition]
  
CONFLICTS WITH: [MASTER-###-###]
  Name: [Existing Concept Name]
  Definition: [Existing Definition]
  
CONFLICT TYPE: [DEFINITION / RELATIONSHIP / SCOPE / SOURCE]
RESOLUTION: [Pending Librarian review]
--------------------------------------------------------------------------------
```

BENEFITS:
- Prevents partial integration (all-or-nothing per batch)
- Consolidated conflict review (efficiency)
- Clean audit trail of decisions
- Rollback capability (staging file preserves original state)


================================================================================
8. VALIDATION PROTOCOL
================================================================================

8.1 FOUR-LEVEL VALIDATION
-------------------------

Apply to all extraction, consolidation, and merge operations.

LEVEL 1: STRUCTURAL
- File integrity (opens, parses)
- Entry completeness (all required fields)
- Format compliance (correct delimiters, structure)

LEVEL 2: COUNT
- Total concept count matches expectation
- Per-domain counts accurate and sum correctly
- ID sequence continuous (no gaps, no duplicates)
- Version numbers incremented appropriately

LEVEL 3: VERBATIM
- Sample 10-15 entries (or 10%, whichever larger)
- Verify definitions match source exactly
- Verify source context quotes accurate
- Check relationship targets exist

LEVEL 4: CROSS-VALIDATION
- Fresh AI context (same or different AI)
- Independent verification against source materials
- Comparison of outputs from different verification passes


8.2 PUSH DEEPER PROTOCOL
------------------------

AI subcontractors often report "all looks good" prematurely. This protocol 
challenges surface-level validation.

TRIGGERS:
- Initial validation passes with no issues flagged
- Suspiciously clean output from known-problematic AI
- High-stakes operation (major merge, large extraction)

PUSH DEEPER SEQUENCE:
1. "Please verify concept [specific ID] against source"
2. "Count the exact number of entries in [domain]"
3. "Quote the first 15 words of definition for [ID]"
4. "List all concepts with CONTRADICTS relationships"
5. "Identify any entries missing Source Context"

EXPECTED RESPONSES:
- Specific, verifiable answers (not "confirmed" or "looks correct")
- Actual counts, actual quotes, actual lists
- Acknowledgment of any issues discovered

RED FLAGS:
- Vague confirmations without specifics
- Counts that don't match earlier claims
- Inability to quote specific content
- Defensive responses or explanations


8.3 CROSS-AI VALIDATION
-----------------------

Use different AI (or same AI in fresh context) for validation.

RATIONALE:
- Same context may carry forward errors
- Different AI may catch different issues
- Fresh context forces re-reading of source material

PROCESS:
1. Complete operation with primary AI
2. Open fresh session with validator AI
3. Provide: source materials + output to validate
4. Request: independent verification against source
5. Compare: validator findings vs. expected results

DISCREPANCY HANDLING:
- Minor discrepancies (<5%): Review samples, determine source of error
- Major discrepancies (>5%): Re-execute operation or manual review
- Systematic errors: Update protocol to prevent recurrence


8.4 LEVEL 5: REFERENTIAL INTEGRITY
----------------------------------

This protocol ensures the conceptual "web" remains intact across multiple 
physical files. Required after any migration, merge, or multi-volume update.

THE CROSS-VOLUME LINKAGE RULE:
Since relationships span separate domain volumes, the risk of "broken links" 
increases during migration and maintenance.

TARGET VERIFICATION:
Every MASTER-ID listed in a RELATIONSHIPS or DEPENDENCIES field must exist 
in either:
- The current volume, OR
- One of the other domain volumes (verified via Master Index)

BIDIRECTIONAL SYNC:
For relationships defined as inherently bidirectional (CONTRADICTS, PARALLELS):
- If Entry A links to Entry B, Entry B MUST contain a reciprocal link to A
- The Relationship Graph generation script handles this automatically
- Validation confirms both entries exist and are properly linked

DEPRECATED ID TRACKING:
When a concept is moved (e.g., from META to CIV-SYS) or merged:
- Any existing relationships in other volumes pointing to the old ID must 
  be updated to the new ID
- The migration map (see Section 6.4) provides the ID mapping
- Search all volumes for references to deprecated IDs

AUTOMATED INTEGRITY CHECK:
Before any volume is marked as validated after a merge or migration:

1. "Extract all unique Target IDs from the RELATIONSHIPS fields of [Volume]"
2. "Cross-reference this list against the Master Index"
3. "Identify any Target IDs that are missing from the Index"
4. "Identify any Target IDs with domain code mismatch"
5. "For CONTRADICTS/PARALLELS, verify reciprocal entries exist"

INTEGRITY CHECK OUTPUT:
```
REFERENTIAL INTEGRITY CHECK
===========================
Volume: MASTER_CON_Vol-CIV-001_v1.0_046.txt
Date: [Date]
Validator: [AI/Human]

Total Relationship Targets: [##]
Targets Verified in Index: [##]
Missing Targets: [##] (list IDs)
Domain Mismatches: [##] (list IDs)
Bidirectional Sync Failures: [##] (list pairs)

STATUS: [PASS / FAIL - requires remediation]
```

REMEDIATION:
- Missing targets: Locate correct ID or flag as extraction gap
- Domain mismatches: Verify correct volume assignment
- Bidirectional failures: Add missing reciprocal relationship


================================================================================
9. REPOSITORY-TO-CARD INTERFACE
================================================================================

This section defines how the Concept Repository feeds the Card System for 
storyboarding and drafting work. See also: Enriched Card Specification for 
the receiving system's format and requirements.

9.1 WHAT REPOSITORY PROVIDES
----------------------------

The repository delivers to the Card System:

STRUCTURAL ELEMENTS:
- MASTER ID (stable reference)
- Concept Name (human-readable label)
- Domain (thematic categorization)
- Definition (core meaning)
- Source Context (grounding language)

RELATIONAL ELEMENTS:
- Dependencies (sequencing constraints)
- Relationships (conceptual connections)

CLASSIFICATION ELEMENTS:
- Novelty (AUTHOR-COINED / FRAMEWORK / ESTABLISHED)
- Explicitness (EXPLICIT / IMPLICIT / DERIVED)

COUNTER-ARGUMENT SUPPORT:
When a card requires FULL treatment with counter-argument mapping, the 
repository provides opposition landscape via relationship queries:

- Query: "What concepts CONTRADICT [MASTER-ID]?"
- Returns: Concepts representing opposing positions or tensions
- Use: Informs card-level counter-argument identification
- Note: CONTRADICTS relationships are bidirectional in the Relationship Graph

Example workflow:
1. Card CARD-001 has Key Concepts: MASTER-CIV-001
2. Query repository: MASTER-CIV-001 CONTRADICTS ?
3. Result: MASTER-CIV-003 (Symbiotic Civilization)
4. Card's Counter-Arguments field informed by this conceptual opposition

The repository does NOT provide:
- Treatment hints (how to write about the concept)
- Series position (where in the series it appears)
- Deployment status (where it's been used)
- Rhetorical guidance (persuasive framing)

LEGACY TREATMENT DATA:
During migration, treatment-relevant fields were extracted to Drafting Data 
Extract files. When creating cards for concepts that existed pre-migration:

- Check: DRAFTING_DATA_EXTRACT_[DOMAIN]_v#.#.txt
- Contains: Legacy treatment hints, keywords, deployment status, series position
- Use: Inform card-level treatment decisions
- Status: Archival once Card System generates this data natively


9.2 WHAT CARDS ADD
------------------

The Card System layers drafting guidance onto repository concepts:

TREATMENT LAYER:
- Treatment Depth (FULL / STANDARD / GIVEN)
- Treatment Notes (specific guidance for this concept in this context)
- Counter-Arguments (for FULL treatment: objections + disposition)

POSITIONING LAYER:
- Article Cluster (which article unit)
- Depends On / Enables (card-level sequencing)
- Source Outline (which outline report the card derives from)

DEPLOYMENT LAYER:
- Status (DRAFT / FLAGGED / READY / ENRICHED)
- Gap Notes (flagged gaps using GAP type taxonomy)


9.3 WORKFLOW SUMMARY
--------------------

CONCEPT-TO-CARD WORKFLOW (GitHub-Enabled):

1. CARD CREATION
   - Identify MASTER IDs needed for article cluster (from outline work)
   - Claude fetches concept entries directly from GitHub-hosted volumes
   - Create card with repository fields populated

2. RETRIEVAL SEQUENCE
   a. Claude fetches Master Index from GitHub
   b. Identify target concepts and their domain volumes
   c. Fetch relevant domain volume section(s)
   d. For FULL treatment cards: query Relationship Graph for CONTRADICTS
   e. If legacy concept: check Drafting Data Extract for treatment hints

3. CARD ENRICHMENT
   - Assign Treatment Depth based on card type and strategic importance
   - Add treatment guidance based on outline context
   - Map counter-arguments (for FULL treatment)
   - Flag gaps using GAP type taxonomy

4. DRAFTING
   - Use card as prompt input for prose generation
   - Repository provides "what" (concept content)
   - Card provides "how" (treatment guidance)
   - Argument Framework applied for FULL treatment elaboration

5. DEPLOYMENT TRACKING
   - Update card status as drafting progresses
   - Repository remains unchanged (pure model)
   - Series artifacts track where concepts appear

RETRIEVAL METHODS:

| Method | When to Use | How |
|--------|-------------|-----|
| GitHub Direct | Default for Claude | Fetch volume URLs directly |
| Index-First | Large queries | Fetch Index, identify targets, fetch volumes |
| Relationship Query | Counter-argument mapping | Fetch Relationship Graph, filter by type |
| Full Volume | Domain-wide work | Fetch entire domain volume |

GITHUB REPOSITORY STRUCTURE:
```
github.com/justinstillness/A47-Pro-2/
├── Volumes/
│   ├── MASTER_CON_Vol-CIV-001_v1.0_046.txt
│   ├── MASTER_CON_Vol-CIV-002_v1.0_052.txt  (if domain grows)
│   ├── MASTER_CON_Vol-CTRL-001_v1.0_053.txt
│   └── ...
├── Index/
│   ├── MASTER_Concept_Index_v2.1_252.txt
│   └── MASTER_Relationship_Graph_v1.0.txt
├── ICR/
│   ├── ICR_Repository_current.txt
│   └── ICR_Index_current.txt
├── Extracts/
│   ├── DRAFTING_DATA_EXTRACT_CIV_v1.0.txt
│   └── ...
├── Guides/
│   ├── Concept_Repository_Guide_v1.2.txt
│   ├── Enriched_Card_Specification_v1.txt
│   └── ...
├── Cards/
│   └── [Card files as developed]
└── Archive/
    └── [Superseded versions]
```

DUAL-INDEX QUERY:
During active editing with ICR concepts:
1. Fetch MASTER_Concept_Index (integrated concepts)
2. Fetch ICR_Index (staging concepts)
3. Search both for concept queries
4. Identify source (MASTER vs ICR) for fetch
5. Cards can reference either: MASTER-CIV-001 or ICR-017

See Appendix E for detailed remote repository access protocol.


9.4 GAP FEEDBACK LOOP
---------------------

When cards flag gaps, this may trigger repository work:

GAP: CONCEPT (Missing conceptual foundation)
--------------------------------------------
This gap type indicates the card needs a concept that may not exist in the 
repository. Resolution pathway:

1. SEARCH REPOSITORY
   - Query Index for near-matches (similar names, related domains)
   - Check Relationship Graph for concepts that might subsume the need
   - If found: Update card's Key Concepts field

2. SEARCH UNPROCESSED SOURCES
   - If not in repository, check pending source packages
   - The 16 source packages awaiting extraction may contain the concept
   - If found: Prioritize that source for extraction

3. FLAG FOR DERIVATION
   - If concept genuinely doesn't exist in source material
   - Flag for Librarian: May need to derive/synthesize new concept
   - New concept flows through standard extraction protocol
   - Once in repository, update card

GAP: EVIDENCE / GAP: SOURCE
---------------------------
These gaps may indicate need for:
- Additional source package processing
- Research material extraction (RES-## sources)
- External source integration

GAP: TRANSITION
---------------
May indicate missing BRIDGE concepts. Check repository for:
- Concepts with EXTENDS relationships that could bridge
- META domain concepts that provide connective tissue

FEEDBACK DOCUMENTATION:
When gap resolution adds concepts to repository:
- Note in session log: "Concept [ID] added to resolve GAP: CONCEPT in CARD-###"
- Maintains traceability between card needs and repository growth


9.5 HANDOFF POINTS
------------------

Repository → Card:
- Query by MASTER ID (primary)
- Query by domain (for cluster work)
- Query by relationship (for counter-argument mapping)
- Fetch via GitHub (default method)

Card → Repository:
- No direct writeback (cards don't modify repository)
- Gap feedback triggers separate repository work
- New concepts follow standard extraction protocol

Card → Draft:
- Card fields inform prose generation
- Repository content provides substance
- Treatment guidance shapes rhetoric

Draft → Card:
- Status updated as drafting progresses
- Enrichment notes may spawn new cards or flag gaps


================================================================================
10. MIGRATION & MAINTENANCE
================================================================================

10.1 CURRENT STATE TO DOMAIN VOLUMES
-------------------------------------

Migration of existing MASTER_Concept_Repository (252 concepts, single file) 
to 10 domain volumes.

PREREQUISITES:
□ This guide reviewed and approved
□ Backup of current MASTER file
□ Session time allocated (multiple sessions likely)

STEP 1: PILOT DOMAIN (CIV-SYS)
- Extract CIV-SYS concepts (46) to new volume format
- Validate entry format compliance
- Generate CIV section of Index
- Test relationship references
- Document issues and adjust specification

STEP 2: DRAFTING DATA EXTRACTION
- Before full migration, extract fields being removed:
  - Treatment Hints
  - Keywords
  - Deployment Status
  - Series Position
  - Any other drafting-relevant data
- Create DRAFTING_DATA_EXTRACT files by domain
- Verify no data loss

STEP 3: REMAINING DOMAINS
- Process each domain following validated pilot process
- Create domain volumes for: CTRL, LIB, EPIST, THEO, HIST, GEOPOL, PSYCH, STRAT, META
- Validate each volume individually

STEP 4: INDEX GENERATION
- Generate complete Master Index spanning all volumes
- Verify counts match (total and per-domain)
- Validate cross-references resolve

STEP 5: RELATIONSHIP GRAPH GENERATION
- Extract all relationships from volumes
- Generate edge-list format graph
- Validate bidirectional relationships appear twice
- Count total relationships

STEP 6: FINAL VALIDATION
- Cross-validate volumes against original MASTER
- Concept-for-concept trace (not sampling)
- Verify no concepts lost or duplicated
- Archive original MASTER file


10.2 DRAFTING DATA EXTRACTION
-----------------------------

Migration strips drafting-relevant fields. These must be preserved for 
Card System use.

DRAFTING DATA EXTRACT FORMAT:
```
================================================================================
DRAFTING DATA EXTRACT - DOMAIN: CIV-SYS
================================================================================
Project: A47-PRO-2
Source: MASTER_Concept_Repository migration
Extracted: [Date]
Concepts: [##]
================================================================================

[MASTER-CIV-001] Technocratic Plantation Model
  TREATMENT: FOUNDATIONAL — Establish early with full explanation. Central metaphor.
  KEYWORDS: technocracy, plantation, control system, dependency, enslavement
  DEPLOYMENT: PUBLISHED:S00
  SERIES POSITION: Article 1, Section 1.2
--------------------------------------------------------------------------------

[MASTER-CIV-002] Trojan Horse Mechanism
  TREATMENT: MECHANISM — Explain how benefits mask control
  KEYWORDS: deception, entrapment, false benefits
  DEPLOYMENT: PUBLISHED:S00
  SERIES POSITION: Article 1, Section 1.3
--------------------------------------------------------------------------------

[Continue for all concepts...]
```

USAGE:
- Reference when building cards for concepts
- Informs treatment decisions during storyboarding
- Archival once Card System generates this data natively


10.3 DOMAIN HEALTH MAINTENANCE
------------------------------

Regular maintenance prevents domains from becoming unwieldy.

MAINTENANCE TRIGGERS:
| Trigger | Action |
|---------|--------|
| META exceeds 50 concepts | Cluster analysis for emergent domains |
| Any domain volume exceeds 75 concepts | Segment into new volume file |
| Any domain exceeds 100 concepts total | Assess subdivision need |
| Quarterly milestone | Audit domain health across all volumes |
| Major extraction batch (>50 concepts) | Post-integration review |

VOLUME SEGMENTATION:
To keep files within optimal fetch size (~50-75KB):
- Target: ~75 concepts per volume file
- Trigger: When volume approaches 100 concepts, split
- Process:
  1. Create new volume file: Vol-[DOMAIN]-002
  2. Move concepts 76+ to new file
  3. Update Index with volume assignments
  4. Verify relationship pointers resolve across both files

ORPHAN DEFINITION:
The audit checklist flags "orphan concepts." Clarification:
- ORPHAN = No incoming OR outgoing relationships AND no dependencies
- Foundational concepts (Dependencies: None) are NOT orphans if they have 
  outgoing relationships (they enable/compose other concepts)
- Concepts with only incoming relationships are legitimate terminal nodes
- True orphans may indicate extraction gaps or classification errors

MAINTENANCE ACTIONS:

CLUSTER ANALYSIS:
- Review META volume for conceptual groupings
- Identify 3+ concepts that form coherent cluster
- Assess if cluster warrants new domain

SUBDIVISION ASSESSMENT:
- Review large domain for natural divisions
- Identify sub-themes that could separate
- Weigh benefits of split vs. complexity added

AUDIT CHECKLIST:
□ Each domain volume opens and parses correctly
□ Concept counts match Index
□ Relationship targets all resolve (Level 5 Referential Integrity)
□ No true orphan concepts (verify foundational concepts are legitimate)
□ Domain assignments still appropriate (no drift)
□ Volume files within size threshold


10.4 NEW DOMAIN PROTOCOL
------------------------

When META accumulates concepts that warrant a new domain:

THRESHOLD:
- 20+ concepts of similar type in META
- Clear thematic coherence
- Distinct from existing domains

PROPOSAL:
1. Identify candidate concepts for new domain
2. Propose domain code and full name
3. Draft domain description
4. Identify relationships to existing domains

EXECUTION:
1. Create new domain volume (empty)
2. Migrate concepts from META to new domain
3. Assign new MASTER IDs in new domain (old IDs deprecated)
4. Update all relationship pointers across all volumes
5. Regenerate Index and Relationship Graph
6. Update Section 2.4 domain table in this guide

DOCUMENTATION:
- Session log captures decision rationale
- Decision log records new domain specification
- This guide updated with new domain


10.5 INDEX UPDATE PROTOCOL
--------------------------

The Master Index must remain synchronized with domain volumes. This protocol 
prevents desync during multi-volume operations.

ATOMIC UPDATE PRINCIPLE:
- Index updates are atomic: one session owns the Index update
- Multi-volume work queues Index updates for single consolidation pass
- Index version increments only after ALL pending volume updates complete

MULTI-VOLUME OPERATION WORKFLOW:
1. LOCK: Declare Index update in progress (note in session log)
2. EXECUTE: Complete all volume modifications
3. COLLECT: Gather all changes requiring Index updates
4. UPDATE: Regenerate Index from current volume states
5. VALIDATE: Verify Index counts match volume contents
6. RELEASE: Push updated Index to GitHub

CONCURRENT WORK HANDLING:
If multiple sessions need to modify volumes:
- Designate one session as "Index Owner" for that work batch
- Other sessions complete volume work, document changes needed
- Index Owner consolidates all updates in single Index regeneration
- Prevents race conditions and version conflicts

INDEX REGENERATION CHECKLIST:
□ All volume files loaded/fetched
□ Concept counts extracted from each volume
□ Total count = sum of all volume counts
□ Domain summary updated
□ All entries present with correct format
□ Version number incremented
□ Generated date updated
□ Push to GitHub replaces previous version


================================================================================
APPENDIX A: EXTRACTION PROMPT TEMPLATE
================================================================================

Use this template when assigning extraction tasks to AI (Gemini/Grok/Claude).

---BEGIN TEMPLATE---

CONCEPT EXTRACTION TASK
=======================

SOURCE FILE: [filename]
SOURCE TAG: [S##, BR, EG, MEMO, etc.]
ESTIMATED CONCEPTS: [##] (based on similar sources)
SESSION: [###]

TASK OBJECTIVE:
Extract all conceptual units from the source material and format as 
repository entries per the specification below.

ENTRY FORMAT:
```
================================================================================
[{SOURCE_TAG}-{DOMAIN}-##] {Concept Name}
================================================================================
Domain: {DOMAIN_CODE}
Source: {SOURCE_TAG} | Original: {this entry's ID}
Novelty: {AUTHOR-COINED / FRAMEWORK / ESTABLISHED}
Explicitness: {EXPLICIT / IMPLICIT / DERIVED}

DEFINITION:
{Complete definition of the concept. Capture full meaning. Verbatim from 
source where possible, synthesized where concept spans multiple passages.}

SOURCE CONTEXT:
"{Direct quote from source, ~50 words max, that grounds this concept}"

DEPENDENCIES:
- {Concept this depends on} OR "None (foundational concept)"

RELATIONSHIPS:
- {TYPE} -> {TARGET-ID} ({Target Concept Name})
================================================================================
```

DOMAIN CODES:
- CIV-SYS: Civilization systems, societal structures
- CTRL-MECH: Control mechanisms and methods
- LIB-MECH: Liberation mechanisms and methods
- EPIST: Epistemology, knowledge, truth
- THEO: Theology, religious/spiritual
- HIST: Historical events and patterns
- GEOPOL: Geopolitics, international relations
- PSYCH: Psychology, individual and collective
- STRAT-OPS: Strategic and tactical operations
- META: Cross-cutting, methodological, uncategorized

RELATIONSHIP TYPES:
- COMPOSES: Part-whole relationship
- ENABLES: Causal/facilitative relationship
- CONTRADICTS: Opposition or tension
- GROUNDS: Foundational support
- PARALLELS: Structural similarity
- EXTENDS: Elaboration or expansion
- INSTANCE OF: Type-token relationship

NOVELTY DETERMINATION:
- AUTHOR-COINED: Term invented by the author
- FRAMEWORK: Existing term used in author's specific framework
- ESTABLISHED: Standard terminology from the field

EXPLICITNESS DETERMINATION:
- EXPLICIT: Directly stated in source
- IMPLICIT: Clearly implied but not directly stated
- DERIVED: Inferred through analysis

REQUIREMENTS:
1. Extract ALL conceptual units—err on side of inclusion
2. Definitions must be VERBATIM where possible
3. Source Context must be EXACT QUOTE
4. Assign domains based on primary focus
5. Flag any concepts that seem to duplicate known entries
6. Number concepts sequentially within each domain

OUTPUT REQUIREMENTS:
- Complete file with all entries
- Header with total count and per-domain counts
- No placeholders, truncation, or summarization
- If output limit approached, STOP and state "INCOMPLETE - [##] concepts 
  extracted of estimated [##]"

VERIFICATION:
Before submitting, confirm:
□ Total concept count: [##]
□ Per-domain counts sum to total
□ All entries have complete required fields
□ No duplicate IDs within this extraction

---END TEMPLATE---


================================================================================
APPENDIX B: SUBCONTRACTOR INSTRUCTION TEMPLATE
================================================================================

Use when delegating consolidation, validation, or other tasks to AI 
subcontractors.

---BEGIN TEMPLATE---

AI SUBCONTRACTOR TASK ASSIGNMENT
================================

TASK: [Consolidation / Validation / Index Generation / etc.]
AI ASSIGNED: [Gemini / Grok / Claude]
SESSION: [###]
DATE: [Date]

INPUTS PROVIDED:
- [File 1]: [description]
- [File 2]: [description]
- [Additional files as needed]

EXPECTED OUTPUT:
- [Output file name]
- [Expected concept count: ###]
- [Expected line count range: #### - ####]

TASK SPECIFICATION:
[Detailed description of what the AI should do]

CRITICAL REQUIREMENTS:
1. Deliver COMPLETE output file (not corrections or patches)
2. Concept count MUST equal: [###]
3. Maintain VERBATIM definitions—no paraphrasing
4. Preserve EXACT source context quotes
5. Follow EXACT format specification provided

PROHIBITED ACTIONS:
- NO placeholders ("[remaining concepts...]", "...", etc.)
- NO truncation (if limit approached, state incomplete)
- NO summarization or paraphrasing of definitions
- NO count modifications from provided figures
- NO format deviations
- NO unauthorized merges or deletions

FAILURE WARNING:
Previous subcontractor outputs have exhibited:
- Definition rewriting (paraphrased instead of verbatim)
- Silent truncation (claimed complete when cut off)
- Count errors (internal inconsistencies)
- Missing concepts (silently omitted entries)

These errors require complete re-work. Please take extra care.

VERIFICATION CHECKLIST:
Before submitting output, complete this checklist:

□ Total concept count: [###] (matches expected)
□ Line count: [####] (within expected range)
□ All entries have all required fields
□ Definitions are verbatim (not paraphrased)
□ Source context quotes are exact
□ No placeholders or truncation markers
□ No duplicate IDs
□ Format matches specification exactly

SUBMIT:
- Complete output file
- Completed verification checklist
- Any issues or anomalies encountered

---END TEMPLATE---


================================================================================
APPENDIX C: VALIDATION CHECKLIST TEMPLATE
================================================================================

Use for validating any extraction, consolidation, or merge output.

---BEGIN TEMPLATE---

VALIDATION CHECKLIST
====================

FILE VALIDATED: [filename]
VALIDATOR: [AI or Human]
DATE: [Date]
SESSION: [###]

LEVEL 1: STRUCTURAL VERIFICATION
--------------------------------
□ File opens without errors
□ All entries parseable (proper delimiters)
□ Header present and correctly formatted
□ Footer/closing present if required
□ No orphan text outside entry boundaries
□ No malformed entries (missing closing markers)

Notes: _______________________________________________

LEVEL 2: COUNT VERIFICATION
---------------------------
Expected total concepts: [###]
Actual total concepts: [###]
□ Counts match

Per-domain verification:
| Domain | Expected | Actual | Match? |
|--------|----------|--------|--------|
| CIV-SYS | [##] | [##] | □ |
| CTRL-MECH | [##] | [##] | □ |
| LIB-MECH | [##] | [##] | □ |
| EPIST | [##] | [##] | □ |
| THEO | [##] | [##] | □ |
| HIST | [##] | [##] | □ |
| GEOPOL | [##] | [##] | □ |
| PSYCH | [##] | [##] | □ |
| STRAT-OPS | [##] | [##] | □ |
| META | [##] | [##] | □ |
| TOTAL | [###] | [###] | □ |

□ No duplicate IDs found
□ No ID gaps in sequence
□ Version numbers correct

Notes: _______________________________________________

LEVEL 3: VERBATIM VERIFICATION
------------------------------
Sample entries checked (minimum 10 or 10%):

| Entry ID | Definition Match? | Context Match? | Fields Complete? |
|----------|-------------------|----------------|------------------|
| [ID] | □ | □ | □ |
| [ID] | □ | □ | □ |
| [ID] | □ | □ | □ |
| [ID] | □ | □ | □ |
| [ID] | □ | □ | □ |
| [ID] | □ | □ | □ |
| [ID] | □ | □ | □ |
| [ID] | □ | □ | □ |
| [ID] | □ | □ | □ |
| [ID] | □ | □ | □ |

□ All sampled definitions match source exactly
□ All sampled context quotes match source exactly
□ All sampled entries have complete required fields
□ Relationship targets exist in repository

Notes: _______________________________________________

LEVEL 4: CROSS-VALIDATION (if applicable)
-----------------------------------------
Cross-validator: [AI or Human]
Cross-validation date: [Date]

□ Independent count verification performed
□ Independent sample verification performed
□ Discrepancies identified and documented

Discrepancies found:
1. _______________________________________________
2. _______________________________________________
3. _______________________________________________

Resolution:
_______________________________________________

LEVEL 5: REFERENTIAL INTEGRITY (for migrations/merges)
------------------------------------------------------
□ All relationship targets verified against Master Index
□ No missing target IDs
□ No domain code mismatches
□ Bidirectional relationships (CONTRADICTS, PARALLELS) have reciprocals
□ No deprecated IDs referenced

Missing Targets: _______________________________________________
Domain Mismatches: _______________________________________________
Bidirectional Failures: _______________________________________________

VALIDATION RESULT
-----------------
□ PASSED - All levels verified
□ PASSED WITH NOTES - Minor issues documented
□ FAILED - Significant issues require re-work

Validator signature: _______________
Date: _______________

---END TEMPLATE---


================================================================================
APPENDIX D: SOURCE TAG MASTER LIST
================================================================================

Complete registry of all source tags for A47-PRO-2.

PUBLISHED SOURCES
-----------------
| Tag | Source | Description | Date Added |
|-----|--------|-------------|------------|
| S00 | Synopsis | A47 Series Synopsis | [Original] |
| S01 | Article 1 | Introduction article | [Original] |
| S02 | Article 2 | Part 1 article | [Original] |
| S03 | Article 3 | Part 2 article | [Original] |
| BR | Briefs | A47 Briefs collection | [Original] |

DRAFT SOURCES
-------------
| Tag | Source | Description | Date Added |
|-----|--------|-------------|------------|
| EG | Endgame | Endgame draft document | [Original] |

INTERNAL SOURCES
----------------
| Tag | Source | Description | Date Added |
|-----|--------|-------------|------------|
| MEMO | Thesis Memo | Strategic thesis notes | [Original] |

COMMENTARY SOURCES
------------------
| Tag | Source | Description | Date Added |
|-----|--------|-------------|------------|
| COM-01 | Commentary 1 | Outline 1 review commentary | [Pending] |
| COM-02 | Commentary 2 | Outline 2 review commentary | [Pending] |
| [Continue as added] |

RESEARCH SOURCES
----------------
| Tag | Source | Description | Date Added |
|-----|--------|-------------|------------|
| [To be added as research materials are processed] |

---

ADDING NEW SOURCES:
1. Determine source type (Published, Draft, Internal, Commentary, Research)
2. Assign next available tag in that category
3. Add to this registry with description and date
4. Update this appendix in Guide

TAG ASSIGNMENT RULES:
- Published articles: S## (sequential by publication order)
- Briefs/collections: Two-letter codes (BR, etc.)
- Drafts: DR-## (sequential by processing order)
- Internal notes: Descriptive codes (MEMO, etc.)
- Commentary: COM-## (matched to outline number)
- Research: RES-## (sequential by processing order)


================================================================================
APPENDIX E: REMOTE REPOSITORY ACCESS PROTOCOL
================================================================================

When concept repository files exceed AI chat upload limits, GitHub hosting 
enables access via URL fetch. This appendix documents the setup, URL patterns, 
and workflow for remote repository access.

Repository URL: https://github.com/justinstillness/A47-Pro-2


E.1 PURPOSE
-----------

GitHub hosting provides:
- Single source of truth for all repository artifacts
- Version history (automatic via Git)
- Remote access for Claude via URL fetch
- Elimination of upload size constraints
- Organized folder structure mirroring system architecture


E.2 REPOSITORY STRUCTURE
------------------------

```
github.com/justinstillness/A47-Pro-2/
├── Volumes/           # Domain-specific concept volumes
├── Index/             # Master indexes and relationship graphs
├── ICR/               # Interim Concept Repository (staging)
├── Extracts/          # Drafting data extracts
├── Guides/            # System documentation (this guide, Card Spec, etc.)
├── Cards/             # Card files (when developed)
├── Extractions/       # ClaCON files from extraction sessions
└── Archive/           # Superseded versions
```


E.3 URL PATTERN FOR FETCH ACCESS
--------------------------------

Claude fetches raw file content using this URL pattern:

https://github.com/[username]/[repo]/raw/refs/heads/main/[folder]/[filename]

Example:
https://github.com/justinstillness/A47-Pro-2/raw/refs/heads/main/Volumes/MASTER_CON_Vol-CIV-001_v1.0_046.txt

IMPORTANT: Spaces in filenames become %20 in URLs. All naming conventions in 
this guide use underscores for GitHub compatibility.


E.4 OBTAINING THE RAW URL
-------------------------

1. Navigate to the file in GitHub
2. Right-click the "Raw" button
3. Select "Copy Link Address"
4. Paste URL into Claude chat for fetch


E.5 FILE NAMING FOR GITHUB
--------------------------

For GitHub-hosted files, use underscores instead of spaces:

| AVOID | PREFER |
|-------|--------|
| Master Concept Index 252.txt | MASTER_Concept_Index_v2.1_252.txt |
| Vol CIV v1.0.txt | MASTER_CON_Vol-CIV-001_v1.0_046.txt |
| ClaCON Extract Session 5.txt | ClaCON05_S04_Session057.txt |

All naming conventions in Section 3.1 are GitHub-compatible.


E.6 UPLOADING FILES
-------------------

Single file:
1. Navigate to target folder in GitHub
2. Click Add file → Upload files
3. Drag file or browse to select
4. Click Commit changes

Multiple files:
Same process—GitHub accepts multiple files per upload.


E.7 UPDATING FILES
------------------

Option A (Edit in place):
1. Navigate to the file in GitHub
2. Click the pencil icon (Edit)
3. Make changes or replace content entirely
4. Click Commit changes

Option B (Replace):
Delete and re-upload the file with the same name.


E.8 VERSION HISTORY
-------------------

GitHub automatically tracks all changes. To view history:
1. Navigate to file
2. Click History (clock icon)
3. View or restore previous versions


E.9 SESSION INTEGRATION
-----------------------

When repository files are needed in a Claude session:

User provides:
```
Please fetch: https://github.com/justinstillness/A47-Pro-2/raw/refs/heads/main/Volumes/MASTER_CON_Vol-CIV-001_v1.0_046.txt
```

Claude fetches and loads into context.

For CON-RES sessions, include relevant GitHub URLs in the bootstrap prompt.

TYPICAL FETCH SEQUENCE:
1. Fetch Master Index (to identify needed concepts)
2. Fetch ICR Index (if working with staging concepts)
3. Fetch specific volume(s) based on concept locations
4. Fetch Relationship Graph (if needed for counter-argument mapping)


E.10 TOKEN CONSIDERATIONS
-------------------------

Fetching does not avoid token usage—file content enters context window same 
as direct upload. Implications:

- Keep volume files under ~75 concepts (~50-75KB) for optimal fetch size
- Use Index-first queries to identify specific needs before fetching volumes
- Segment large domains into multiple volume files (see Section 10.3)
- For large operations, fetch only the volumes actually needed


QUICK REFERENCE CARD
--------------------

| ACTION | STEPS |
|--------|-------|
| Upload file | Folder → Add file → Upload files → Commit |
| Get raw URL | Click file → Right-click "Raw" → Copy link |
| Update file | Click file → Pencil icon → Edit → Commit |
| View history | Click file → History |
| Fetch in Claude | Paste raw URL in chat |


================================================================================
END OF CONCEPT REPOSITORY GUIDE
================================================================================
Version: 1.2
Status: DRAFT
Next Review: After CIV-SYS pilot migration

Document History:
- v1.2 (2026-01-08): Added ICR system (Section 6.4), Level 5 Referential 
  Integrity (Section 8.4), Batch Conflict Staging (Section 7.4), Index Update 
  Protocol (Section 10.5), volume segmentation, GitHub integration (Appendix E),
  updated naming conventions for scalability (Session CON-RES-003)
- v1.1 (2026-01-08): Enhanced Section 9 with GitHub retrieval, counter-argument 
  support, gap feedback loop, Card Spec alignment (Session CON-RES-003)
- v1.0 (2026-01-08): Initial draft (Session CON-RES-003)
